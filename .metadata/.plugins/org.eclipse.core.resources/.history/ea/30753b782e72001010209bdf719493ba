#ifndef LED_MATRIX_H
#define LED_MATRIX_H

#include <stdint.h>
#include "stm32f4xx.h"  // CMSIS core header

#define MATRIX_ROWS 8
#define MATRIX_COLS 8

typedef struct {
    GPIO_TypeDef* row_ports[MATRIX_ROWS];
    uint16_t row_pins[MATRIX_ROWS];
    GPIO_TypeDef* col_ports[MATRIX_COLS];
    uint16_t col_pins[MATRIX_COLS];
    uint8_t buffer[MATRIX_ROWS];
    uint8_t current_row;
    uint8_t brightness;
} LED_Matrix;

// Initialize LED matrix
void LEDMX_Init(LED_Matrix* matrix);

// Clear the entire matrix
void LEDMX_Clear(LED_Matrix* matrix);

// Set a single pixel state (1=on, 0=off)
void LEDMX_SetPixel(LED_Matrix* matrix, uint8_t x, uint8_t y, uint8_t state);

// Must be called periodically (e.g., from SysTick)
void LEDMX_Refresh(LED_Matrix* matrix);

// Load an entire frame (row-major order)
void LEDMX_LoadFrame(LED_Matrix* matrix, const uint8_t frame[MATRIX_ROWS]);

#endif
