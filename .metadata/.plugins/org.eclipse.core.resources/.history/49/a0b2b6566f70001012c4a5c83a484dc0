#include "NVIC_priv.h"

#include "NVIC_interface.h"

void NVIC_vEnableIRQ(uint8_t IRQNumber)
{
    MNVIC->ISER[IRQNumber / 32] = (1UL << (IRQNumber % 32));
}

void NVIC_vDisableIRQ(uint8_t IRQNumber)
{
    MNVIC->ICER[IRQNumber / 32] = (1UL << (IRQNumber % 32));
}

void NVIC_vSetPendingFlag(uint8_t IRQNumber)
{
    MNVIC->ISPR[IRQNumber / 32] = (1UL << (IRQNumber % 32));
}

void NVIC_vClearPendingFlag(uint8_t IRQNumber)
{
    MNVIC->ICPR[IRQNumber / 32] = (1UL << (IRQNumber % 32));
}

uint8_t NVIC_vGetActiveFlag(uint8_t IRQNumber)
{
    return (MNVIC->IABR[IRQNumber / 32] >> (IRQNumber % 32)) & 1;
}

void NVIC_vSetPriority(uint8_t IRQNumber, uint8_t Priority)
{
    MNVIC->IPR[IRQNumber] = Priority << 4;  // STM32 uses only top 4 bits
}
